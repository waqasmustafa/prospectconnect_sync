<?xml version="1.0" encoding="utf-8"?>
<!-- prospectconnect_sync/views/pc_settings_view.xml -->
<odoo>
    <record id="res_config_settings_view_form_pc" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.inherit.prospectconnect</field>
        <field name="model">res.config.settings</field>
        <field name="inherit_id" ref="base.res_config_settings_view_form"/>
        <field name="arch" type="xml">
            
            <!-- Use the same anchor as GoHighLevel reference -->
            <xpath expr="//block[@id='user_default_rights']" position="before">
                
                <block title="ProspectConnect Sync" id="pc_sync_block">
                    
                    <setting string="API Configuration"
                             help="Configure ProspectConnect API key and base URL.">
                        <div class="row">
                            <field name="pc_api_key"
                                   password="True"
                                   placeholder="API Key from ProspectConnect"
                                   class="col-6"/>
                            <field name="pc_base_url"
                                   placeholder="https://api.prospectconnect.ai"
                                   class="col-6"/>
                        </div>
                        <div class="row mt16">
                            <div class="col-12">
                                <button name="action_pc_test_connection"
                                        string="Test Connection"
                                        type="object"
                                        icon="fa-plug"
                                        class="btn btn-secondary"/>
                            </div>
                        </div>
                    </setting>
                    
                    <setting string="Sync Behavior"
                             help="Configure sync direction and when to send updates.">
                        <div class="row">
                            <field name="pc_sync_direction"
                                   class="col-6"/>
                            <field name="pc_trigger_mode"
                                   class="col-6"/>
                        </div>
                    </setting>
                    
                    <setting string="What To Sync"
                             help="Enable or disable different record types.">
                        <!-- Row 1: Contacts and Opportunities -->
                        <div class="row mb-2">
                            <div class="col-6">
                                <field name="pc_sync_contacts"/>
                                <label for="pc_sync_contacts" string="Contacts"/>
                            </div>
                            <div class="col-6">
                                <field name="pc_sync_deals"/>
                                <label for="pc_sync_deals" string="Opportunities"/>
                            </div>
                        </div>
                        <!-- Row 2: Tasks and Notes -->
                        <div class="row">
                            <div class="col-6">
                                <field name="pc_sync_tasks"/>
                                <label for="pc_sync_tasks" string="Tasks"/>
                            </div>
                            <div class="col-6">
                                <field name="pc_sync_notes"/>
                                <label for="pc_sync_notes" string="Notes"/>
                            </div>
                        </div>
                    </setting>
                    
                    <setting string="Polling Interval"
                             help="How often Odoo should poll ProspectConnect for updates (PC â†’ Odoo).">
                        <div class="row">
                            <field name="pc_poll_interval_minutes"
                                   class="col-4"
                                   placeholder="5"/>
                            <span class="col-8 o_form_label">Minutes between polls (cron).</span>
                        </div>
                    </setting>
                    
                    <setting string="Last Sync Timestamps"
                             help="Read-only info about last pull times.">
                        <!-- Row 1: Contacts and Opportunities -->
                        <div class="row mb-2">
                            <div class="col-6">
                                <label for="pc_last_sync_contacts" string="Contacts" class="fw-bold d-block"/>
                                <field name="pc_last_sync_contacts" readonly="1" nolabel="1" style="width: 100%; white-space: nowrap;"/>
                            </div>
                            <div class="col-6">
                                <label for="pc_last_sync_deals" string="Opportunities" class="fw-bold d-block"/>
                                <field name="pc_last_sync_deals" readonly="1" nolabel="1" style="width: 100%; white-space: nowrap;"/>
                            </div>
                        </div>
                        <!-- Row 2: Tasks and Notes -->
                        <div class="row">
                            <div class="col-6">
                                <label for="pc_last_sync_tasks" string="Tasks" class="fw-bold d-block"/>
                                <field name="pc_last_sync_tasks" readonly="1" nolabel="1" style="width: 100%; white-space: nowrap;"/>
                            </div>
                            <div class="col-6">
                                <label for="pc_last_sync_notes" string="Notes" class="fw-bold d-block"/>
                                <field name="pc_last_sync_notes" readonly="1" nolabel="1" style="width: 100%; white-space: nowrap;"/>
                            </div>
                        </div>
                    </setting>
                    
                    <setting string="Manual Sync Now"
                             help="Click 'Save' first, then use this button to pull changes immediately.">
                        <!-- Row 1: Sync Now button -->
                        <div class="row mb-2">
                            <div class="col-12">
                                <button name="action_pc_sync_now"
                                        string="Sync Now"
                                        type="object"
                                        class="btn btn-primary"/>
                            </div>
                        </div>
                        <!-- Row 2: Fetch buttons -->
                        <div class="row">
                            <div class="col-6">
                                <button name="action_pc_fetch_pipelines"
                                        string="Fetch Pipelines"
                                        type="object"
                                        class="btn btn-secondary"/>
                            </div>
                            <div class="col-6">
                                <button name="action_pc_fetch_users"
                                        string="Fetch Users"
                                        type="object"
                                        class="btn btn-secondary"/>
                            </div>
                        </div>
                    </setting>
                    
                </block>
                
            </xpath>
        </field>
    </record>
    
    <!-- Action for Settings -->
    <record id="action_pc_config_settings" model="ir.actions.act_window">
        <field name="name">Settings</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.config.settings</field>
        <field name="view_mode">form</field>
        <field name="target">inline</field>
        <field name="context">{'module': 'prospectconnect_sync'}</field>
    </record>
    
</odoo>
